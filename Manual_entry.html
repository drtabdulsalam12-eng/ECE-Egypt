<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฅุฏุฎุงู ุงูุจูุงูุงุช ูุฏููุงู - ุงูุฎุทูุฉ 1</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <div class="progress-bar">
            <div class="progress-step active"><span>1</span></div>
            <div class="progress-line"></div>
            <div class="progress-step"><span>2</span></div>
            <div class="progress-line"></div>
            <div class="progress-step"><span>3</span></div>
            <div class="progress-line"></div>
            <div class="progress-step"><span>4</span></div>
            <div class="progress-line"></div>
            <div class="progress-step"><span>5</span></div>
        </div>

        <div class="form-container">
            <h1>ุงูุฎุทูุฉ 1: ุฅุฏุฎุงู ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ</h1>
            <p class="step-description">ูู ุจุฅุฏุฎุงู ุจูุงูุงุชู ุงูุดุฎุตูุฉ ูุฏููุงู</p>

            <form id="manualEntryForm">
                <div class="form-section">
                    <h3>ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ</h3>

                    <div class="form-group">
                        <label for="nationalId">ุงูุฑูู ุงููููู *</label>
                        <input type="text" id="nationalId" name="national_id" required 
                               pattern="[2-3][0-9]{13}" 
                               maxlength="14"
                               placeholder="ุฃุฏุฎู ุงูุฑูู ุงููููู (14 ุฑูู)">
                        <small style="color: #546e7a; display: block; margin-top: 5px;">ุงูุฑูู ุงููููู ูุฌุจ ุฃู ูููู 14 ุฑูู</small>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="birthDate">ุชุงุฑูุฎ ุงููููุงุฏ</label>
                            <input type="text" id="birthDate" name="birth_date" readonly placeholder="ุณููููุฃ ุชููุงุฆูุงู ูู ุงูุฑูู ุงููููู">
                        </div>

                        <div class="form-group">
                            <label for="age">ุงูุณู</label>
                            <input type="number" id="age" name="age" readonly placeholder="ุณููููุฃ ุชููุงุฆูุงู">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="idCardFile">ุงูุจุทุงูุฉ ุงูุดุฎุตูุฉ (ุงูุฑูู ุงููููู) *</label>
                        <input type="file" id="idCardFile" name="idCardFile" accept=".pdf,.jpg,.jpeg,.png" required>
                        <small style="color: #546e7a; display: block; margin-top: 5px;">ูู ุจุฑูุน ุตูุฑุฉ ุฃู ููู PDF ูุจุทุงูุชู ุงูุดุฎุตูุฉ</small>
                    </div>

                    <div class="form-group">
                        <label for="governorate">ููุงู ุงููููุงุฏ *</label>
                        <select id="governorate" name="governorate" required>
                            <option value="">ุงุฎุชุฑ ุงููุญุงูุธุฉ</option>
                            <option value="ุงููุงูุฑุฉ">ุงููุงูุฑุฉ</option>
                            <option value="ุงูุฅุณููุฏุฑูุฉ">ุงูุฅุณููุฏุฑูุฉ</option>
                            <option value="ุจูุฑุณุนูุฏ">ุจูุฑุณุนูุฏ</option>
                            <option value="ุงูุณููุณ">ุงูุณููุณ</option>
                            <option value="ุฏููุงุท">ุฏููุงุท</option>
                            <option value="ุงูุฏููููุฉ">ุงูุฏููููุฉ</option>
                            <option value="ุงูุดุฑููุฉ">ุงูุดุฑููุฉ</option>
                            <option value="ุงูููููุจูุฉ">ุงูููููุจูุฉ</option>
                            <option value="ููุฑ ุงูุดูุฎ">ููุฑ ุงูุดูุฎ</option>
                            <option value="ุงูุบุฑุจูุฉ">ุงูุบุฑุจูุฉ</option>
                            <option value="ุงููููููุฉ">ุงููููููุฉ</option>
                            <option value="ุงูุจุญูุฑุฉ">ุงูุจุญูุฑุฉ</option>
                            <option value="ุงูุฅุณูุงุนูููุฉ">ุงูุฅุณูุงุนูููุฉ</option>
                            <option value="ุงูุฌูุฒุฉ">ุงูุฌูุฒุฉ</option>
                            <option value="ุจูู ุณููู">ุจูู ุณููู</option>
                            <option value="ุงููููู">ุงููููู</option>
                            <option value="ุงููููุง">ุงููููุง</option>
                            <option value="ุฃุณููุท">ุฃุณููุท</option>
                            <option value="ุณููุงุฌ">ุณููุงุฌ</option>
                            <option value="ููุง">ููุง</option>
                            <option value="ุฃุณูุงู">ุฃุณูุงู</option>
                            <option value="ุงูุฃูุตุฑ">ุงูุฃูุตุฑ</option>
                            <option value="ุงูุจุญุฑ ุงูุฃุญูุฑ">ุงูุจุญุฑ ุงูุฃุญูุฑ</option>
                            <option value="ุงููุงุฏู ุงูุฌุฏูุฏ">ุงููุงุฏู ุงูุฌุฏูุฏ</option>
                            <option value="ูุทุฑูุญ">ูุทุฑูุญ</option>
                            <option value="ุดูุงู ุณููุงุก">ุดูุงู ุณููุงุก</option>
                            <option value="ุฌููุจ ุณููุงุก">ุฌููุจ ุณููุงุก</option>
                        </select>
                    </div>
                </div>

                <div id="errorMessage" class="error-message" style="display: none;"></div>

                <div class="form-actions">
                    <a href="Upload_id.html" class="btn btn-secondary">ุฑุฌูุน</a>
                    <button type="submit" class="btn btn-primary">ุงูุชุงูู</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const nationalIdInput = document.getElementById('nationalId');
        const birthDateInput = document.getElementById('birthDate');
        const ageInput = document.getElementById('age');
        const governorateSelect = document.getElementById('governorate');
        const errorMessage = document.getElementById('errorMessage');

        const governorates = {
            '01': 'ุงููุงูุฑุฉ',
            '02': 'ุงูุฅุณููุฏุฑูุฉ',
            '03': 'ุจูุฑุณุนูุฏ',
            '04': 'ุงูุณููุณ',
            '11': 'ุฏููุงุท',
            '12': 'ุงูุฏููููุฉ',
            '13': 'ุงูุดุฑููุฉ',
            '14': 'ุงูููููุจูุฉ',
            '15': 'ููุฑ ุงูุดูุฎ',
            '16': 'ุงูุบุฑุจูุฉ',
            '17': 'ุงููููููุฉ',
            '18': 'ุงูุจุญูุฑุฉ',
            '19': 'ุงูุฅุณูุงุนูููุฉ',
            '21': 'ุงูุฌูุฒุฉ',
            '22': 'ุจูู ุณููู',
            '23': 'ุงููููู',
            '24': 'ุงููููุง',
            '25': 'ุฃุณููุท',
            '26': 'ุณููุงุฌ',
            '27': 'ููุง',
            '28': 'ุฃุณูุงู',
            '29': 'ุงูุฃูุตุฑ',
            '31': 'ุงูุจุญุฑ ุงูุฃุญูุฑ',
            '32': 'ุงููุงุฏู ุงูุฌุฏูุฏ',
            '33': 'ูุทุฑูุญ',
            '34': 'ุดูุงู ุณููุงุก',
            '35': 'ุฌููุจ ุณููุงุก'
        };

        nationalIdInput.addEventListener('input', function() {
            const nationalId = this.value;

            if (nationalId.length === 14) {
                try {
                    const century = nationalId[0] === '2' ? '19' : '20';
                    const year = century + nationalId.substr(1, 2);
                    const month = nationalId.substr(3, 2);
                    const day = nationalId.substr(5, 2);

                    birthDateInput.value = `${year}-${month}-${day}`;

                    calculateAge();

                    const govCode = nationalId.substr(7, 2);
                    if (governorates[govCode]) {
                        governorateSelect.value = governorates[govCode];
                    }

                    errorMessage.style.display = 'none';
                } catch (e) {
                    errorMessage.textContent = 'ุงูุฑูู ุงููููู ุบูุฑ ุตุญูุญ';
                    errorMessage.style.display = 'block';
                }
            }
        });

        birthDateInput.addEventListener('change', calculateAge);

        function calculateAge() {
            const birthDate = new Date(birthDateInput.value);
            const today = new Date();
            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDiff = today.getMonth() - birthDate.getMonth();

            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }

            ageInput.value = age;
        }

        document.getElementById('manualEntryForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const nationalId = nationalIdInput.value;
            const birthDate = birthDateInput.value;
            const age = ageInput.value;
            const idCardFile = document.getElementById('idCardFile').files[0];

            if (nationalId.length !== 14) {
                errorMessage.textContent = 'ุงูุฑูู ุงููููู ูุฌุจ ุฃู ูููู 14 ุฑูู';
                errorMessage.style.display = 'block';
                return false;
            }

            if (!nationalId.match(/^[2-3][0-9]{13}$/)) {
                errorMessage.textContent = 'ุงูุฑูู ุงููููู ุบูุฑ ุตุญูุญ';
                errorMessage.style.display = 'block';
                return false;
            }

            if (!birthDate || !age) {
                errorMessage.textContent = 'ูุฑุฌู ุฅุฏุฎุงู ุงูุฑูู ุงููููู ูุงููุงู (14 ุฑูู) ููุชู ุญุณุงุจ ุชุงุฑูุฎ ุงููููุงุฏ ูุงูุณู ุชููุงุฆูุงู';
                errorMessage.style.display = 'block';
                return false;
            }

            if (parseInt(age) < 18) {
                errorMessage.textContent = 'ุนุฐุฑุงูุ ูุฌุจ ุฃู ูููู ุนูุฑู 18 ุณูุฉ ุนูู ุงูุฃูู ููุชุณุฌูู';
                errorMessage.style.display = 'block';
                return false;
            }

            if (!idCardFile) {
                errorMessage.textContent = 'ูุฑุฌู ุฑูุน ุงูุจุทุงูุฉ ุงูุดุฎุตูุฉ';
                errorMessage.style.display = 'block';
                return false;
            }

            // ุงูุชุญูู ูู ููุน ุงูููู
            const allowedTypes = ['application/pdf', 'image/jpeg', 'image/png', 'image/jpg'];
            if (!allowedTypes.includes(idCardFile.type)) {
                errorMessage.textContent = 'ููุน ุงูููู ุบูุฑ ูุฏุนูู. ูุฑุฌู ุฑูุน ููู PDF ุฃู ุตูุฑุฉ (JPG, PNG)';
                errorMessage.style.display = 'block';
                return false;
            }

            // ุชุญููู ุงูููู ุฅูู Base64 ูุญูุธ
            const reader = new FileReader();
            reader.onload = function(e) {
                localStorage.setItem('manualEntryData', JSON.stringify({
                    nationalId: nationalId,
                    birthDate: birthDate,
                    age: age,
                    governorate: governorateSelect.value
                }));
                
                localStorage.setItem('idCardFile', e.target.result);
                localStorage.setItem('idCardFileName', idCardFile.name);

                window.location.href = 'Personal_info.html';
            };
            reader.readAsDataURL(idCardFile);
        });
    </script>

    <div class="contact-float" id="contactButton">
        <div class="icon">๐ฌ</div>
    </div>

    <div class="contact-modal" id="contactModal">
        <div class="contact-modal-content">
            <button class="modal-close" id="closeModal">ร</button>
            <h2>ุชูุงุตู ูุนูุง</h2>
            <div class="contact-info">
                <div class="contact-item">
                    <div class="icon">๐ง</div>
                    <div class="text">
                        <strong>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</strong><br>
                        <a href="mailto:dr.t.abdulsalam12@gmail.com">dr.t.abdulsalam12@gmail.com</a>
                    </div>
                </div>
                <div class="contact-item">
                    <div class="icon">โฐ</div>
                    <div class="text">
                        <strong>ุณุงุนุงุช ุงูุนูู:</strong><br>
                        ุงูุฃุญุฏ - ุงูุฎููุณ: 10 ุตุจุงุญุงู - 6 ูุณุงุกู
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/contact.js"></script>
</body>
</html>
